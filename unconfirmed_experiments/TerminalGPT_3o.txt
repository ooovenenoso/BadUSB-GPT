REM Author: ooovenenoso
REM Simple terminal ChatGPT using GPT-3.5
DELAY 500
GUI x
DELAY 2000
STRING a
DELAY 2000
LEFTARROW
DELAY 2000
ENTER
DELAY 500
STRING $apiKey = 'YOUR_OPENAI_API_KEY'
ENTER
STRING $headers = @{ Authorization = "Bearer $apiKey"; 'Content-Type' = 'application/json' }
ENTER
STRING $messages = @()
ENTER
STRING while($true){
ENTER
STRING     $input = Read-Host 'You'
ENTER
STRING     if ($input -eq 'exit'){ break }
ENTER
STRING     $messages += @{role='user';content=$input}
ENTER
STRING     $body = @{model='gpt-3.5-turbo';messages=$messages} | ConvertTo-Json
ENTER
STRING     Write-Host 'Assistant: ...'
ENTER
STRING     $resp = Invoke-RestMethod -Uri 'https://api.openai.com/v1/chat/completions' -Method POST -Headers $headers -Body $body
ENTER
STRING     $answer = $resp.choices[0].message.content.Trim()
ENTER
STRING     Write-Host "Assistant: $answer"
ENTER
STRING     $messages += @{role='assistant';content=$answer}
ENTER
STRING }
ENTER
